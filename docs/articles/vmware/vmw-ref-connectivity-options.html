<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Understanding connectivity options in UKCloud for VMware </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Understanding connectivity options in UKCloud for VMware ">
    <meta name="generator" content="docfx 2.45.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container-fluid">
            <div class="navbar-margin-left">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                
                <a class="navbar-brand" href="../../index.html">
                  <img id="logo" class="svg" src="../../styles/assets/logo.png" srcset="../../styles/assets/logo@2x.png 2x" width="300" height="49" alt="">
                </a>
              </div>
              <div class="collapse navbar-collapse" id="navbar">
                <form class="navbar-form navbar-right" role="search" id="search">
                  <div class="form-group">
                    <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                  </div>
                </form>
              </div>
            </div>
          </div>
        </nav>
        
        <div class="navbar-borderless subnav navbar navbar-default">
          <div class="navbar-right subnav-margin-right">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/UKCloud/documentation/blob/master/articles/vmware/vmw-ref-connectivity-options.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
          </div>
          <div class="hide-when-search subnav-margin-left" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container-fluid body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="container-fluid">
            <div class="row">
              <div class="col-lg-10">
                <article class="content wrap" id="_content" data-uid="">
                  
<h1 id="understanding-connectivity-options-in-ukcloud-for-vmware">Understanding connectivity options in UKCloud for VMware</h1>

<h2 id="introduction">Introduction</h2>
<p>In UKCloud for VMware, UKCloud uses two different architecture designs. You can see this when you deploy virtual data centres (VDCs) onto our IaaS offering. Depending on the type of application you're running, you may see one or both types of network architecture when you deploy your solutions onto the UKCloud platform.</p>
<p>This document explains what the different architectures look like so you can design your solutions to make the best use of them.</p>
<h2 id="overview-of-ukcloud-for-vmware-network-architecture">Overview of UKCloud for VMware network architecture</h2>
<p>Our UKCloud for VMware service uses multiple security domains (Assured, Elevated and the Cross Domain Security Zone), enabling you to provide a service over the internet, government community networks (such as N3, PSN or JANET) or your own HybridConnect lines.</p>
<p>Each of these networks brings its own challenges for network separation and prevention of accidental bridging. Our network architecture offers two different options to address these challenges. Your Cloud Architect will be able to advise you which solution works best for your application.</p>
<ul>
<li><p><strong>Network Firewall Tenant (NFT)</strong> - NFTs are either single- or multi tenant instances on Network Firewalls (NFWs), depending on the network that the VDC is connected to. NFWs share an external network connectivity layer connected to the government community network. NFT architecture is used in regions 1, 2, 7 and 8.</p>
</li>
<li><p><strong>Cloud Fabric and gateway</strong> - There are no NFTs on shared firewalls, instead we use a shared Cloud Fabric and the separation of connection types is done at the edge level. Cloud Fabric and gateway architecture is used in regions 5 and 6.</p>
</li>
</ul>
<h2 id="nft-network-architecture">NFT network architecture</h2>
<p>With our NFT network architecture, we use a slightly different design, depending on the network you are connecting to. If you've already used UKCloud IaaS then you'll probably already be familiar with the way the NFT architecture presents itself.</p>
<h3 id="single-network-architecture-internet">Single network architecture (internet)</h3>
<p>All VDCs on the Assured platform have outbound connectivity to the internet. When connecting a VDC to the internet (and no other network), we use the architecture shown the diagram below.</p>
<p><img src="images/fig1_nft_single.png" alt="Single network architecture (NFT)"></p>
<p>You can see that Customer 1 has two VDCs, each of which has its own edge connected to the same NFT. Customer 1 and Customer 2 have separate NFTs on the same multi‑tenant NFW, which is on the shared internet facing network.</p>
<p>From a customer management experience, you manage all your connectivity rules, such as firewall, IPsec VPN and NAT functionality, through your edge, using either the UKCloud Portal GUI or API.</p>
<p>We manage the NFW and provide additional controls around whitelisted ports, metering and packet shaping.</p>
<h3 id="multiple-network-architecture-psn-assured-and-n3">Multiple network architecture (PSN Assured and N3)</h3>
<p>If you want to add other networks to your VDC (for example, the health and social care network (N3) or PSN Assured), you can enable these connections through the same edge as your internet connection. This is possible because the separation of connectivity happens at the NFT. The NFT resides on a single tenant NFW to comply with the security requirements of these networks.</p>
<p><img src="images/fig2_nft_multi.png" alt="Multiple network architecture (NFT)"></p>
<p>In the diagram above, you can see that Customer 3 uses the same edge to connect to both the internet and the N3 network through an NFT on a single tenant NFW. Customer 4 uses a similar architecture to connect to the internet and PSN Assured.</p>
<p>Management-wise, you can see the external IP range on the edge. Typically, you use this range for internet connectivity. However, in the case of PSN Assured and N3, we translate the address on the NFW before routing it to the edge. You won't see your PSN Assured or N3 address in your IP allocation, but your users will need to target the address to reach your service.</p>
<h4 id="psn-assured">PSN Assured</h4>
<p>If you're adding PSN Assured connectivity to a VDC, we translate each PSN Assured IP address to one of your external IP allocations, consuming one of your internet IPs.</p>
<h4 id="n3">N3</h4>
<p>If you're adding N3 connectivity to a VDC, we translate the N3 IP to one of the following:</p>
<ul>
<li><p>One of your external IP allocations, consuming an internet IP.</p>
</li>
<li><p>A private address of your choice, bypassing the edge and enabling you to route the traffic directly to a virtual machine (VM) with the same private address. This retains your external IP allocation but limits the use of your N3 IP address.</p>
</li>
</ul>
<h3 id="multiple-network-architecture-janet">Multiple network architecture (Janet)</h3>
<p>If you want to connect to the Janet network, the network architecture is slightly different to that of other government community networks.</p>
<p><img src="images/fig3_nft_janet.png" alt="Multiple network architecture for Janet"></p>
<p>As Janet is a new network in the UKCloud portfolio, we're able to
leverage the changes to network connectivity in UKCloud for VMware. This means we can utilise the Cloud Fabric and Gateway model to
present the Janet connection.</p>
<p>In the diagram above, you can see two edges on the VDC: one presents the internet connectivity, and the other presents the Janet connectivity. The Janet-facing edge connects into the Janet Cloud Fabric and then out to the Janet network via the UKCloud managed gateway.</p>
<p>The Janet facing edge has the same functionality as the internet facing edge and you can see your Janet IP address in the IP allocations on the edge. You manage the internet facing and Janet facing edges separately through the UKCloud Portal GUI or API.</p>
<h3 id="networking-in-the-elevated-platform">Networking in the Elevated platform</h3>
<p>Networking in the Elevated platform is very similar to the Assured platform. All connectivity is routed through the same edge on the VDC, and separation of connections occurs within the NFT.</p>
<p><img src="images/fig4_nft_elevated.png" alt="Network architecture in the Elevated platform"></p>
<h4 id="psn-protected">PSN Protected</h4>
<p>In the diagram above, Customer 1's PSN Protected connection is routed to their NFT sitting in the multi-tenant NFW. This then provides the onward connection to Customer 1's edge. The same NFT also handles the connections in from Cross Domain Security Zone products (Walled Garden and SRA).</p>
<p>It's worth noting that UKCloud translates the PSN Protected IP address to one of the external IP ranges that are available on the edge. Your users will target the PSN Protected IP address, however you'll see only your UKCloud allocated external range on your edge, so it's important to know what your PSN Protected IP has been translated to.</p>
<h4 id="rli">RLI</h4>
<p>The RLI is also available in the Elevated platform, however it is not natively connected to the UKCloud platform. This means that, to facilitate a connection to the RLI, you must go through the assurance process provided by the MOD to gain access to the RLI; only then can we complete the connection between the RLI and your VDC. The NFT for RLI sits in a single tenant NFW in line with MOD connection compliance.</p>
<h3 id="networking-between-vdcs">Networking between VDCs</h3>
<p>You have three options when networking between VDCs. Each option has a slightly different use case.</p>
<h4 id="option-1-shared-networks">Option 1: Shared networks</h4>
<p>Shared networks are useful when you have multiple VDCs within the same organisation boundary (sometimes referred to as a vOrg). You can create networks that span VDCs, enabling VMs within different VDCs to communicate with each other. This is particularly useful if you have VDCs with VMs that are operating at different service levels (ESSENTIAL, POWER and PRIORITY) and need to have inter-VM communication.</p>
<p><img src="images/fig5_nft_shared_network.png" alt="VDC communication using shared networks"></p>
<h4 id="option-2-ipsec-vpn">Option 2: IPsec VPN</h4>
<p>If you need VDC communication between VDCs that reside either in different regions, vOrgs or even in external data centres then you should use IPsec VPN tunnels. You can configure these on the edges of the VDCs that you are connecting. It's worth noting that you should configure the IPsec tunnels using your external IP address allocation, in both the Assured and Elevated platforms. In the Assured platform, each IPsec tunnel consumes an external (internet) IP.</p>
<p><img src="images/fig6_nft_ipsec_vpn.png" alt="VDC communication using IPsec VPN (NFT)"></p>
<h4 id="option-3-static-routes">Option 3: Static routes</h4>
<p>Use static routes as an alternative to a shared network where you want more control of traffic between VMs if the VDCs you're connecting reside on the same NFT. As traffic must traverse the edge, you can put in extra rules around connectivity to lock down communication between VMs in different VDCs. This enables you to construct DMZs or separate out services to different users while continuing to communicate between your VMs.</p>
<p><img src="images/fig7_nft_static_routes.png" alt="VDC communication using static routes (NFT)"></p>
<h3 id="bringing-your-own-firewall">Bringing your own firewall</h3>
<p>In most circumstances, the UKCloud provided edge will work for your solution. However, if your solution requires next generation firewall functionality, such as malware detection, antivirus protection, URL filtering or complex load balancing, you can provide your own firewall solution. Note that if you choose to bring your own firewall, you're completely responsible for the deployment, configuration and management of that firewall.</p>
<p>If you plan to deploy a firewall into a new VDC, let us know and we'll provision you a VDC with a dedicated network for you to deploy your firewall onto.</p>
<p>If you change from a UKCloud‑provided firewall to your own firewall, we'll redeploy your firewall on to a dedicated network and you'll need to migrate your environment to that network.</p>
<p><img src="images/fig8_nft_byof.png" alt="Bring your own firewall (NFT)"></p>
<h3 id="ip-address-allocations">IP address allocations</h3>
<p>When you create a new vOrg, we'll provide you with a number of usable IP addresses per project, depending on the network you are connecting to:</p>
<ul>
<li><p>Internet - 5 x usable IPs</p>
</li>
<li><p>N3 - 1 x usable IP</p>
</li>
<li><p>PSN Assured - 1 x usable IP</p>
</li>
<li><p>Janet - 1 x usable IP</p>
</li>
<li><p>PSN Protected - 1 x usable IP</p>
</li>
</ul>
<p>You can request additional IP addresses as required by raising a Service Request via the <a href="https://portal.skyscapecloud.com/support/ivanti">My Calls</a> section of the UKCloud Portal. If you ask for a large number of IP addresses in a single request, we may ask you to provide further information to support your request.</p>
<h2 id="cloud-fabric-and-gateway-architecture">Cloud Fabric and gateway architecture</h2>
<p>The Cloud Fabric architecture utilises multi-tenant networks connected to UKCloud-managed gateways that provide external network connectivity to internet and government networks. The customer-managed edges are connected to the multi-tenant network and enable you to control firewall settings such as NAT, VPN and load balancing. There are no NFTs in the Cloud Fabric architecture so all the firewall settings are controlled by the edge VM.</p>
<h3 id="single-network-architecture">Single network architecture</h3>
<p>The diagram below shows how VDCs connected to a single network look using our new Cloud Fabric and gateway architecture.</p>
<p><img src="images/fig9_fabric_single.png" alt="Single network architecture (cloud fabric)"></p>
<p>You can see that there is no NFT layer; instead each customer VDC has a edge that is connected directly into the multi‑tenant Cloud Fabric. This is then connected to a UKCloud‑managed gateway with onward connection to the internet.</p>
<p>From a customer management experience, you manage all your connectivity rules, such as firewall, IPsec VPN and NAT functionality through your edge, using either the UKCloud Portal GUI or API.</p>
<p>UKCloud controls the gateway out to the internet and provides metering and packet shaping, however you are in full control of ports.</p>
<h3 id="multiple-network-architecture">Multiple network architecture</h3>
<p>Most differences between NFT and Cloud Fabric can be seen with multiple network architectures. To achieve network separation and ensure security and compliance with government community networks, we've developed a new VDC edge architecture.</p>
<p><img src="images/fig10_fabric_multi.png" alt="Multiple network architecture (cloud fabric)"></p>
<p>In the diagram above, you can see that if you want to add other networks to your VDC (for example, N3, PSN Assured or Janet), you need separate edges to facilitate that connection. These edges have the same style of connectivity as the internet facing edge: an edge that connects into a Cloud Fabric, dedicated to that particular network, which then has onward connectivity to the government community network through the UKCloud‑managed gateway.</p>
<p>Customer management is on a per-edge basis. You'll see multiple edges within your UKCloud Portal GUI and you'll need to manage these individually. The full functionality of each edge is available for every network connectivity, however UKCloud manages the port whitelist for all government connected networks.</p>
<h3 id="network-architecture-for-the-elevated-platform">Network architecture for the Elevated platform</h3>
<p>Networking in the Elevated platform is the same as the Assured platform from a management perspective. Just like the Assured platform, there is edge separation for the different networks that feed into the Elevated platform.</p>
<p><img src="images/fig11_fabric_elevated.png" alt="Network architecture in the Elevated platform (Cloud Fabric)"></p>
<p>As the diagram above shows, the edge is connected to a Cloud Fabric with nward connectivity to the PSN Protected network. There is also an internal Cloud Fabric that connects the Elevated VDC to the Walled Garden, enabling cross-security domain communication.</p>
<h3 id="networking-between-vdcs-1">Networking between VDCs</h3>
<p>You have two options for communicating between VDCs. Both these options will be familiar if you already use our platform, but if you're used to using static routes, you'll need to use one of the two options below instead for all inter-VDC communication.</p>
<h4 id="option-1-shared-networks-1">Option 1: Shared networks</h4>
<p>Shared networks are useful when you have multiple VDCs within the same vOrg and region. You can create networks that span between VDCs, enabling VMs within different VDCs to communicate. This is particularly useful if you have VDCs with VMs that are operating at different service levels (ESSENTIAL, POWER and PRIORITY) and need to have inter-VM communication.</p>
<p><img src="images/fig12_fabric_shared_network.png" alt="VDC communication using shared networks (Cloud Fabric)"></p>
<h4 id="option-2-ipsec-vpn-1">Option 2: IPsec VPN</h4>
<p>If you need VDC communication between VDCs that reside either in different regions, vOrgs or even in external data centres then you should use IPsec VPN tunnels. You can configure these on the edges of the VDCs that you are connecting. It's worth noting that you should configure the IPsec tunnels using your external IP address allocation, in both the Assured and Elevated platforms. In the Assured platform, each IPsec tunnel consumes an external (internet) IP.</p>
<p><img src="images/fig13_fabric_ipsec_vpn.png" alt="VDC communication using IPsec VPN in the Assured platform (Cloud Fabric)"></p>
<p>In the Elevated platform each IPsec tunnel consumes either:</p>
<ul>
<li><p>An external (UKCloud) IP, if the tunnel is configured between VDCs</p>
</li>
<li><p>An external (PSN Protected) IP, if the tunnel is configured between a VDC and an endpoint on the PSN Protected network</p>
</li>
</ul>
<p><img src="images/fig14_fabric_ipsec_vpn_elevated.png" alt="VDC communication using IPsec VPN in the Elevated platform (Cloud Fabric)"></p>
<h3 id="bringing-your-own-firewall-1">Bringing your own firewall</h3>
<p>In most circumstances, the UKCloud‑provided edge will work for your solution. However, if your solution requires next generation firewall functionality, such as malware detection, antivirus protection, URL filtering or complex load balancing, you can provide your own firewall solution. Note that if you choose to bring your own firewall, you're completely responsible for the deployment, configuration and management of that firewall.</p>
<p>If you plan to deploy a firewall into a new VDC, let us know and we'll provision you a VDC with a dedicated network for you to deploy your firewall onto.</p>
<p>If you change from a UKCloud‑provided firewall to your own firewall, we'll redeploy your firewall on to a dedicated network and you'll need to migrate your environment to that network.</p>
<p><img src="images/fig15_fabric_byof.png" alt="Bring your own firewall (Cloud Fabric)"></p>
<h3 id="ip-address-allocation">IP address allocation</h3>
<p>The number of public IP addresses we provide depends on whether you are using a UKCloud‑provided firewall or bringing your own:</p>
<ul>
<li><p><strong>UKCloud provided firewall</strong> - If you're using a UKCloud‑provided firewall, we'll allocate you a single usable IP per VDC edge. You can request additional IP addresses as required by raising a Service Request via the <a href="https://portal.skyscapecloud.com/support/ivanti">My Calls</a> section of the UKCloud Portal. If you ask for a large number of IP addresses in a single request, we may ask you to provide further information to support your request.</p>
</li>
<li><p><strong>BYOF</strong> - If you're using your own firewall technology, when you provision your VDC, we initially allocate you five public IP addresses. After this initial allocation, you can request more IP addresses by opening a Service Request via the <a href="https://portal.skyscapecloud.com/support/ivanti">My Calls</a> section of the UKCloud Portal.</p>
</li>
</ul>
<h2 id="maintaining-compliance-with-multiple-networks">Maintaining compliance with multiple networks</h2>
<p>When connecting to the different UKCloud networks it's important to ensure that you uphold network connection compliance. To this end, the way you access the different government community networks has not changed in Enterprise Cloud Compute.</p>
<p>In the Assured platform, you'll always have an internet connected edge. Access to other networks is as follows:</p>
<ul>
<li><p>For N3 you'll need to go through the UKCloud aggregation process</p>
</li>
<li><p>For PSN Assured you'll need to get accreditation for the service you wish to provide from the PSN Authority</p>
</li>
<li><p>For Janet you'll need to engage with your Cloud Architect</p>
</li>
</ul>
<p>In the Elevated platform:</p>
<ul>
<li><p>For PSN Protected you'll need to gain approval from the PSN Authority</p>
</li>
<li><p>For RLI you'll need to get approval from the MOD</p>
</li>
<li><p>For Cross Domain Security Zone services (Walled Garden or SRA) you'll need to get the authorisation from your end-customer IA as well as the UKCloud SIRO</p>
</li>
</ul>
<p>The application processes haven't changed for any of these services, however it's important to be mindful about how you may have to design your architecture based on the network architecture you'll be deployed on. As an example, when connecting to the N3 network, you'll need to ensure that the N3 and internet networks aren't bridged. With the Cloud Fabric architecture and NFT architecture (shown in the two diagrams below respectively), you should ensure that VMs are not connected to both the internet and to N3
at the same time.</p>
<p><img src="images/fig16_fabric_n3.png" alt="N3 network connectivity using Cloud Fabric"></p>
<p><img src="images/fig17_nft_n3.png" alt="N3 connectivity using NFT"></p>
<h2 id="feedback">Feedback</h2>
<p>If you find an issue with this article, click <strong>Improve this Doc</strong> to suggest a change. If you have an idea for how we could improve any of our services, visit the <a href="https://community.ukcloud.com/ideas">Ideas</a> section of the <a href="https://community.ukcloud.com">UKCloud Community</a>.</p>


                  <div class="row">
                  </div>
                </article>
              </div>
              
              <div class="hidden-sm col-md-2" role="complementary">
                <div class="sideaffix">
                  <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                  <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
                  </nav>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right text-right">
              Generated by <strong>DocFX</strong><br>
              <a href="#top">Back to top</a>
            </span>
            <span>&copy <a href="https://ukcloud.com">UKCloud Ltd</a>, 2020. All Rights Reserved.<br><a href="https://ukcloud.com/legal">Privacy Policy. </a><a href="https://ukcloud.com/terms-and-conditions">Terms of Use. </a><a href="https://docs.ukcloud.com/articles/other/other-how-contribute-knowledge.html">Contribute. </a></span>
          </div>
        </div>
      </footer>
      
      <div id="cookie-cta" style="display: none;" aria-hidden="true">
        <div class="cookie-cta-inner container">
          <div class="cookie-cta-text">
            <p>
              The <strong>UKCloud Knowledge Centre</strong> uses cookies to ensure that we give you the best experience on our website. If you continue we assume that you consent to receive all cookies on this website.
            </p>
          </div>
      
          <div class="cookie-cta-action">
            <button class="cookie-cta-close button button--small">Accept</button>
          </div>
        </div>
      </div>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
    <script type="text/javascript" src="../../styles/highlight.js"></script>
    <!-- Enable Terraform syntax highlighting -->
    <script type="text/javascript" src="../../styles/terraform.js"></script>
    <script type="text/javascript">
      hljs.registerLanguage('terraform', window.hljsDefineTerraform);
      hljs.initHighlightingOnLoad();
    </script>
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-57433193-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-57433193-6');
    </script>
  </body>
</html>
